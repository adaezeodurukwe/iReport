{"version":3,"sources":["userController.js"],"names":["Helper","User","createUser","req","res","password","encryptedPassword","body","newUser","Model","create","firstname","lastname","username","othernames","email","phone","userToken","generateToken","id","status","send","data","token","user","error","message","login","getOne","match","compare"],"mappings":";;;;;;AAEA;;;;AACA;;IAAYA,M;;;;;;AAGZ;;;AANA;;AASA,MAAMC,IAAN,CAAW;AACP;;;;;;AAMA,iBAAaC,UAAb,CAAwBC,GAAxB,EAA6BC,GAA7B,EAAkC;AAC9B,cAAMC,WAAWL,OAAOM,iBAAP,CAAyBH,IAAII,IAAJ,CAASF,QAAlC,CAAjB;AACA,YAAI;AACA,kBAAMG,UAAU,MAAMC,oBAAMC,MAAN,CAClBP,IAAII,IAAJ,CAASI,SADS,EAElBR,IAAII,IAAJ,CAASK,QAFS,EAGlBT,IAAII,IAAJ,CAASM,QAHS,EAIlBV,IAAII,IAAJ,CAASO,UAJS,EAKlBX,IAAII,IAAJ,CAASQ,KALS,EAMlBV,QANkB,EAOlBF,IAAII,IAAJ,CAASS,KAPS,CAAtB;AASA,kBAAMC,YAAYjB,OAAOkB,aAAP,CAAqBV,QAAQW,EAA7B,CAAlB;AACA,mBAAOf,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,wBAAQ,GADgB;AAExBE,sBAAM,CAAC;AACHC,2BAAON,SADJ;AAEHO,0BAAMhB;AAFH,iBAAD;AAFkB,aAArB,CAAP;AAOH,SAlBD,CAkBE,OAAOiB,KAAP,EAAc;AACZ,mBAAOrB,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBK,yBAASD;AADe,aAArB,CAAP;AAGH;AACJ;;AAED;;;;;;AAMA,iBAAaE,KAAb,CAAmBxB,GAAnB,EAAwBC,GAAxB,EAA6B;AACzB,YAAI;AACA,kBAAMoB,OAAO,MAAMf,oBAAMmB,MAAN,CAAazB,IAAII,IAAJ,CAASQ,KAAtB,CAAnB;;AAEA,gBAAI,CAACS,IAAL,EAAW;AACP,uBAAOpB,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,4BAAQ,GADgB;AAExBM,6BAAS;AAFe,iBAArB,CAAP;AAIH;;AAED,kBAAMG,QAAQ,MAAM7B,OAAO8B,OAAP,CAAe3B,IAAII,IAAJ,CAASF,QAAxB,EAAkCmB,KAAKnB,QAAvC,CAApB;AACA,gBAAI,CAACwB,KAAL,EAAY;AACR,uBAAOzB,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEK,SAAS,sBAAX,EAArB,CAAP;AACH;AACD,kBAAMT,YAAYjB,OAAOkB,aAAP,CAAqBM,KAAKL,EAA1B,CAAlB;AACA,mBAAOf,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,wBAAQ,GADgB;AAExBE,sBAAM,CAAC;AACHC,2BAAON,SADJ;AAEH;AACAO,0BAAMA;AAHH,iBAAD;AAFkB,aAArB,CAAP;AAQH,SAvBD,CAuBE,OAAOC,KAAP,EAAc;AACZ,mBAAOrB,IAAIgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBK,yBAASD;AADe,aAArB,CAAP;AAGH;AACJ;AArEM;;kBAwEIxB,I","file":"userController.js","sourceRoot":"C:/Users/user pc/Documents/iReport/server/controller","sourcesContent":["// User controller\r\n\r\nimport Model from '../model/userModel';\r\nimport * as Helper from './helper';\r\n\r\n\r\n/**\r\n * @class User\r\n */\r\nclass User {\r\n    /**\r\n     * @async createUser\r\n     * @param {*} req\r\n     * @param {*} res\r\n     * @returns {object}\r\n     */\r\n    static async createUser(req, res) {\r\n        const password = Helper.encryptedPassword(req.body.password);\r\n        try {\r\n            const newUser = await Model.create(\r\n                req.body.firstname,\r\n                req.body.lastname,\r\n                req.body.username,\r\n                req.body.othernames,\r\n                req.body.email,\r\n                password,\r\n                req.body.phone,\r\n            );\r\n            const userToken = Helper.generateToken(newUser.id);\r\n            return res.status(201).send({\r\n                status: 201,\r\n                data: [{\r\n                    token: userToken,\r\n                    user: newUser,\r\n                }],\r\n            });\r\n        } catch (error) {\r\n            return res.status(500).send({\r\n                message: error,\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @async login\r\n     * @param {*} req\r\n     * @param {*} res\r\n     * @returns {object}\r\n     */\r\n    static async login(req, res) {\r\n        try {\r\n            const user = await Model.getOne(req.body.email);\r\n\r\n            if (!user) {\r\n                return res.status(404).send({\r\n                    status: 404,\r\n                    message: 'user not found',\r\n                });\r\n            }\r\n\r\n            const match = await Helper.compare(req.body.password, user.password);\r\n            if (!match) {\r\n                return res.status(400).send({ message: 'incorrect crdentials' });\r\n            }\r\n            const userToken = Helper.generateToken(user.id);\r\n            return res.status(200).send({\r\n                status: 200,\r\n                data: [{\r\n                    token: userToken,\r\n                    // eslint-disable-next-line object-shorthand\r\n                    user: user,\r\n                }],\r\n            });\r\n        } catch (error) {\r\n            return res.status(500).send({\r\n                message: error,\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default User;\r\n"]}