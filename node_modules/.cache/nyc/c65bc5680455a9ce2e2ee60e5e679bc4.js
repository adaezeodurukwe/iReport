'use strict';var cov_5pmoydv8t=function(){var path="C:\\Users\\user pc\\Documents\\iReport\\server\\controller\\redflagController.js",hash="0fc6e271b6e265ce4078137aae1d28a4c7db5ac4",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"C:\\Users\\user pc\\Documents\\iReport\\server\\controller\\redflagController.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:20},end:{line:7,column:52}},"2":{start:{line:9,column:21},end:{line:9,column:58}},"3":{start:{line:11,column:39},end:{line:11,column:93}},"4":{start:{line:21,column:8},end:{line:35,column:9}},"5":{start:{line:22,column:30},end:{line:22,column:163}},"6":{start:{line:23,column:12},end:{line:30,column:15}},"7":{start:{line:32,column:12},end:{line:34,column:15}},"8":{start:{line:45,column:8},end:{line:55,column:9}},"9":{start:{line:46,column:31},end:{line:46,column:78}},"10":{start:{line:47,column:12},end:{line:50,column:15}},"11":{start:{line:52,column:12},end:{line:54,column:15}},"12":{start:{line:65,column:8},end:{line:83,column:9}},"13":{start:{line:66,column:31},end:{line:66,column:93}},"14":{start:{line:68,column:12},end:{line:73,column:13}},"15":{start:{line:69,column:16},end:{line:72,column:19}},"16":{start:{line:75,column:12},end:{line:78,column:15}},"17":{start:{line:80,column:12},end:{line:82,column:15}},"18":{start:{line:93,column:8},end:{line:112,column:9}},"19":{start:{line:94,column:36},end:{line:94,column:113}},"20":{start:{line:96,column:12},end:{line:101,column:13}},"21":{start:{line:97,column:16},end:{line:100,column:19}},"22":{start:{line:103,column:12},end:{line:107,column:15}},"23":{start:{line:109,column:12},end:{line:111,column:15}},"24":{start:{line:122,column:8},end:{line:141,column:9}},"25":{start:{line:123,column:35},end:{line:123,column:110}},"26":{start:{line:125,column:12},end:{line:130,column:13}},"27":{start:{line:126,column:16},end:{line:129,column:19}},"28":{start:{line:132,column:12},end:{line:136,column:15}},"29":{start:{line:138,column:12},end:{line:140,column:15}},"30":{start:{line:151,column:8},end:{line:170,column:9}},"31":{start:{line:152,column:34},end:{line:152,column:96}},"32":{start:{line:154,column:12},end:{line:159,column:13}},"33":{start:{line:155,column:16},end:{line:158,column:19}},"34":{start:{line:161,column:12},end:{line:165,column:15}},"35":{start:{line:167,column:12},end:{line:169,column:15}},"36":{start:{line:174,column:0},end:{line:174,column:26}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:11,column:9},end:{line:11,column:31}},loc:{start:{line:11,column:37},end:{line:11,column:95}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:4},end:{line:20,column:5}},loc:{start:{line:20,column:40},end:{line:36,column:5}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:44,column:4},end:{line:44,column:5}},loc:{start:{line:44,column:42},end:{line:56,column:5}},line:44},"3":{name:"(anonymous_3)",decl:{start:{line:64,column:4},end:{line:64,column:5}},loc:{start:{line:64,column:41},end:{line:84,column:5}},line:64},"4":{name:"(anonymous_4)",decl:{start:{line:92,column:4},end:{line:92,column:5}},loc:{start:{line:92,column:49},end:{line:113,column:5}},line:92},"5":{name:"(anonymous_5)",decl:{start:{line:121,column:4},end:{line:121,column:5}},loc:{start:{line:121,column:48},end:{line:142,column:5}},line:121},"6":{name:"(anonymous_6)",decl:{start:{line:150,column:4},end:{line:150,column:5}},loc:{start:{line:150,column:41},end:{line:171,column:5}},line:150}},branchMap:{"0":{loc:{start:{line:11,column:46},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:70},end:{line:11,column:73}},{start:{line:11,column:76},end:{line:11,column:92}}],line:11},"1":{loc:{start:{line:11,column:46},end:{line:11,column:67}},type:"binary-expr",locations:[{start:{line:11,column:46},end:{line:11,column:49}},{start:{line:11,column:53},end:{line:11,column:67}}],line:11},"2":{loc:{start:{line:68,column:12},end:{line:73,column:13}},type:"if",locations:[{start:{line:68,column:12},end:{line:73,column:13}},{start:{line:68,column:12},end:{line:73,column:13}}],line:68},"3":{loc:{start:{line:96,column:12},end:{line:101,column:13}},type:"if",locations:[{start:{line:96,column:12},end:{line:101,column:13}},{start:{line:96,column:12},end:{line:101,column:13}}],line:96},"4":{loc:{start:{line:125,column:12},end:{line:130,column:13}},type:"if",locations:[{start:{line:125,column:12},end:{line:130,column:13}},{start:{line:125,column:12},end:{line:130,column:13}}],line:125},"5":{loc:{start:{line:154,column:12},end:{line:159,column:13}},type:"if",locations:[{start:{line:154,column:12},end:{line:159,column:13}},{start:{line:154,column:12},end:{line:159,column:13}}],line:154}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_5pmoydv8t.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _recordsModel=(cov_5pmoydv8t.s[1]++,require('../model/recordsModel'));var _recordsModel2=(cov_5pmoydv8t.s[2]++,_interopRequireDefault(_recordsModel));function _interopRequireDefault(obj){cov_5pmoydv8t.f[0]++;cov_5pmoydv8t.s[3]++;return(cov_5pmoydv8t.b[1][0]++,obj)&&(cov_5pmoydv8t.b[1][1]++,obj.__esModule)?(cov_5pmoydv8t.b[0][0]++,obj):(cov_5pmoydv8t.b[0][1]++,{default:obj});}class Records{/**
     * @async createRecord
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async createRecord(req,res){cov_5pmoydv8t.f[1]++;cov_5pmoydv8t.s[4]++;try{const newRecord=(cov_5pmoydv8t.s[5]++,await _recordsModel2.default.create(req.userId,req.body.type,req.body.location,req.body.images,req.body.videos,req.body.comment));cov_5pmoydv8t.s[6]++;return res.status(201).send({status:201,data:[{id:newRecord.id,message:'Created red-flag record',record:newRecord}]});}catch(error){cov_5pmoydv8t.s[7]++;return res.status(500).send({message:error});}}/**
     * @async getAllRedflags
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async getAllRedflags(req,res){cov_5pmoydv8t.f[2]++;cov_5pmoydv8t.s[8]++;try{const allRecords=(cov_5pmoydv8t.s[9]++,await _recordsModel2.default.getAll(req.userId));cov_5pmoydv8t.s[10]++;return res.status(200).send({status:200,data:allRecords});}catch(error){cov_5pmoydv8t.s[11]++;return res.status(500).send({message:error});}}/**
     * @async
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async getOneRedflag(req,res){cov_5pmoydv8t.f[3]++;cov_5pmoydv8t.s[12]++;try{const oneRedflag=(cov_5pmoydv8t.s[13]++,await _recordsModel2.default.getOne(req.userId,req.params.id));cov_5pmoydv8t.s[14]++;if(!oneRedflag){cov_5pmoydv8t.b[2][0]++;cov_5pmoydv8t.s[15]++;return res.status(404).send({status:404,message:'Red-flag not found'});}else{cov_5pmoydv8t.b[2][1]++;}cov_5pmoydv8t.s[16]++;return res.status(200).send({status:200,data:oneRedflag});}catch(error){cov_5pmoydv8t.s[17]++;return res.status(500).send({message:error});}}/**
     * @async updateRedflagLocation
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async updateRedflagLocation(req,res){cov_5pmoydv8t.f[4]++;cov_5pmoydv8t.s[18]++;try{const updatedLocation=(cov_5pmoydv8t.s[19]++,await _recordsModel2.default.updateLocation(req.params.id,req.body.location));cov_5pmoydv8t.s[20]++;if(!updatedLocation){cov_5pmoydv8t.b[3][0]++;cov_5pmoydv8t.s[21]++;return res.status(404).send({status:404,message:'Red-flag not found'});}else{cov_5pmoydv8t.b[3][1]++;}cov_5pmoydv8t.s[22]++;return res.status(200).send({status:200,message:'Updated red-flag record\'s location',data:updatedLocation});}catch(error){cov_5pmoydv8t.s[23]++;return res.status(500).send({message:error});}}/**
     * @async updateRedflagComment
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async updateRedflagComment(req,res){cov_5pmoydv8t.f[5]++;cov_5pmoydv8t.s[24]++;try{const updatedComment=(cov_5pmoydv8t.s[25]++,await _recordsModel2.default.updateComment(req.params.id,req.body.comment));cov_5pmoydv8t.s[26]++;if(!updatedComment){cov_5pmoydv8t.b[4][0]++;cov_5pmoydv8t.s[27]++;return res.status(404).send({status:404,message:'Red-flag not found'});}else{cov_5pmoydv8t.b[4][1]++;}cov_5pmoydv8t.s[28]++;return res.status(200).send({status:200,message:'Updated red-flag record\'s comment',data:updatedComment});}catch(error){cov_5pmoydv8t.s[29]++;return res.status(500).send({message:error});}}/**
     * @async deleteRedflag
     * @param {*} req
     * @param {*} res
     * @returns {object}
     */static async deleteRedflag(req,res){cov_5pmoydv8t.f[6]++;cov_5pmoydv8t.s[30]++;try{const deleteRedflag=(cov_5pmoydv8t.s[31]++,await _recordsModel2.default.delete(req.userId,req.params.id));cov_5pmoydv8t.s[32]++;if(!deleteRedflag){cov_5pmoydv8t.b[5][0]++;cov_5pmoydv8t.s[33]++;return res.status(404).send({status:404,message:'Red-flag not found'});}else{cov_5pmoydv8t.b[5][1]++;}cov_5pmoydv8t.s[34]++;return res.status(200).send({status:200,message:'red-flag record has been deleted',data:deleteRedflag});}catch(error){cov_5pmoydv8t.s[35]++;return res.status(500).send({message:error});}}}// Records controller
cov_5pmoydv8t.s[36]++;exports.default=Records;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZGZsYWdDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlJlY29yZHMiLCJjcmVhdGVSZWNvcmQiLCJyZXEiLCJyZXMiLCJuZXdSZWNvcmQiLCJNb2RlbCIsImNyZWF0ZSIsInVzZXJJZCIsImJvZHkiLCJ0eXBlIiwibG9jYXRpb24iLCJpbWFnZXMiLCJ2aWRlb3MiLCJjb21tZW50Iiwic3RhdHVzIiwic2VuZCIsImRhdGEiLCJpZCIsIm1lc3NhZ2UiLCJyZWNvcmQiLCJlcnJvciIsImdldEFsbFJlZGZsYWdzIiwiYWxsUmVjb3JkcyIsImdldEFsbCIsImdldE9uZVJlZGZsYWciLCJvbmVSZWRmbGFnIiwiZ2V0T25lIiwicGFyYW1zIiwidXBkYXRlUmVkZmxhZ0xvY2F0aW9uIiwidXBkYXRlZExvY2F0aW9uIiwidXBkYXRlTG9jYXRpb24iLCJ1cGRhdGVSZWRmbGFnQ29tbWVudCIsInVwZGF0ZWRDb21tZW50IiwidXBkYXRlQ29tbWVudCIsImRlbGV0ZVJlZGZsYWciLCJkZWxldGUiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVBOzs7Ozs7QUFFQSxNQUFNQSxPQUFOLENBQWM7QUFDVjs7Ozs7O0FBTUEsaUJBQWFDLFlBQWIsQ0FBMEJDLEdBQTFCLEVBQStCQyxHQUEvQixFQUFvQztBQUNoQyxZQUFJO0FBQ0Esa0JBQU1DLFlBQVksTUFBTUMsdUJBQU1DLE1BQU4sQ0FDcEJKLElBQUlLLE1BRGdCLEVBRXBCTCxJQUFJTSxJQUFKLENBQVNDLElBRlcsRUFHcEJQLElBQUlNLElBQUosQ0FBU0UsUUFIVyxFQUlwQlIsSUFBSU0sSUFBSixDQUFTRyxNQUpXLEVBS3BCVCxJQUFJTSxJQUFKLENBQVNJLE1BTFcsRUFNcEJWLElBQUlNLElBQUosQ0FBU0ssT0FOVyxDQUF4QjtBQVFBLG1CQUFPVixJQUFJVyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDeEJELHdCQUFRLEdBRGdCO0FBRXhCRSxzQkFBTSxDQUFDO0FBQ0hDLHdCQUFJYixVQUFVYSxF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R0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDeEJHLHlCQUFTRTtBQURlLGFBQXJCLENBQVA7QUFHSDtBQUNKO0FBdEtTLEMsQ0FKZDs7a0JBNEtlcEIsTyIsImZpbGUiOiJyZWRmbGFnQ29udHJvbGxlci5qcyIsInNvdXJjZVJvb3QiOiJDOi9Vc2Vycy91c2VyIHBjL0RvY3VtZW50cy9pUmVwb3J0L3NlcnZlci9jb250cm9sbGVyIiwic291cmNlc0NvbnRlbnQiOlsiLy8gUmVjb3JkcyBjb250cm9sbGVyXHJcblxyXG5pbXBvcnQgTW9kZWwgZnJvbSAnLi4vbW9kZWwvcmVjb3Jkc01vZGVsJztcclxuXHJcbmNsYXNzIFJlY29yZHMge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAYXN5bmMgY3JlYXRlUmVjb3JkXHJcbiAgICAgKiBAcGFyYW0geyp9IHJlcVxyXG4gICAgICogQHBhcmFtIHsqfSByZXNcclxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBjcmVhdGVSZWNvcmQocmVxLCByZXMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdSZWNvcmQgPSBhd2FpdCBNb2RlbC5jcmVhdGUoXHJcbiAgICAgICAgICAgICAgICByZXEudXNlcklkLFxyXG4gICAgICAgICAgICAgICAgcmVxLmJvZHkudHlwZSxcclxuICAgICAgICAgICAgICAgIHJlcS5ib2R5LmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgcmVxLmJvZHkuaW1hZ2VzLFxyXG4gICAgICAgICAgICAgICAgcmVxLmJvZHkudmlkZW9zLFxyXG4gICAgICAgICAgICAgICAgcmVxLmJvZHkuY29tbWVudCxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIHN0YXR1czogMjAxLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogW3tcclxuICAgICAgICAgICAgICAgICAgICBpZDogbmV3UmVjb3JkLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdDcmVhdGVkIHJlZC1mbGFnIHJlY29yZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVjb3JkOiBuZXdSZWNvcmQsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXN5bmMgZ2V0QWxsUmVkZmxhZ3NcclxuICAgICAqIEBwYXJhbSB7Kn0gcmVxXHJcbiAgICAgKiBAcGFyYW0geyp9IHJlc1xyXG4gICAgICogQHJldHVybnMge29iamVjdH1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzeW5jIGdldEFsbFJlZGZsYWdzKHJlcSwgcmVzKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgYWxsUmVjb3JkcyA9IGF3YWl0IE1vZGVsLmdldEFsbChyZXEudXNlcklkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogYWxsUmVjb3JkcyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAYXN5bmNcclxuICAgICAqIEBwYXJhbSB7Kn0gcmVxXHJcbiAgICAgKiBAcGFyYW0geyp9IHJlc1xyXG4gICAgICogQHJldHVybnMge29iamVjdH1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzeW5jIGdldE9uZVJlZGZsYWcocmVxLCByZXMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBvbmVSZWRmbGFnID0gYXdhaXQgTW9kZWwuZ2V0T25lKHJlcS51c2VySWQsIHJlcS5wYXJhbXMuaWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFvbmVSZWRmbGFnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogNDA0LFxyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdSZWQtZmxhZyBub3QgZm91bmQnLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDIwMCxcclxuICAgICAgICAgICAgICAgIGRhdGE6IG9uZVJlZGZsYWcsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvcixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGFzeW5jIHVwZGF0ZVJlZGZsYWdMb2NhdGlvblxyXG4gICAgICogQHBhcmFtIHsqfSByZXFcclxuICAgICAqIEBwYXJhbSB7Kn0gcmVzXHJcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgYXN5bmMgdXBkYXRlUmVkZmxhZ0xvY2F0aW9uKHJlcSwgcmVzKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdXBkYXRlZExvY2F0aW9uID0gYXdhaXQgTW9kZWwudXBkYXRlTG9jYXRpb24ocmVxLnBhcmFtcy5pZCwgcmVxLmJvZHkubG9jYXRpb24pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCF1cGRhdGVkTG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiA0MDQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1JlZC1mbGFnIG5vdCBmb3VuZCcsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VwZGF0ZWQgcmVkLWZsYWcgcmVjb3JkXFwncyBsb2NhdGlvbicsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiB1cGRhdGVkTG9jYXRpb24sXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvcixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGFzeW5jIHVwZGF0ZVJlZGZsYWdDb21tZW50XHJcbiAgICAgKiBAcGFyYW0geyp9IHJlcVxyXG4gICAgICogQHBhcmFtIHsqfSByZXNcclxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyB1cGRhdGVSZWRmbGFnQ29tbWVudChyZXEsIHJlcykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRDb21tZW50ID0gYXdhaXQgTW9kZWwudXBkYXRlQ29tbWVudChyZXEucGFyYW1zLmlkLCByZXEuYm9keS5jb21tZW50KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghdXBkYXRlZENvbW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiA0MDQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1JlZC1mbGFnIG5vdCBmb3VuZCcsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VwZGF0ZWQgcmVkLWZsYWcgcmVjb3JkXFwncyBjb21tZW50JyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHVwZGF0ZWRDb21tZW50LFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEBhc3luYyBkZWxldGVSZWRmbGFnXHJcbiAgICAgKiBAcGFyYW0geyp9IHJlcVxyXG4gICAgICogQHBhcmFtIHsqfSByZXNcclxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBkZWxldGVSZWRmbGFnKHJlcSwgcmVzKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgZGVsZXRlUmVkZmxhZyA9IGF3YWl0IE1vZGVsLmRlbGV0ZShyZXEudXNlcklkLCByZXEucGFyYW1zLmlkKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghZGVsZXRlUmVkZmxhZykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDQwNCxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnUmVkLWZsYWcgbm90IGZvdW5kJyxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAncmVkLWZsYWcgcmVjb3JkIGhhcyBiZWVuIGRlbGV0ZWQnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogZGVsZXRlUmVkZmxhZyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUmVjb3JkcztcclxuIl19