'use strict';var cov_oydsjrny2=function(){var path="C:\\Users\\user pc\\Documents\\iReport\\server\\controller\\helper.js",hash="53d92af3166ef5998318689705ce2c21ab03424f",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"C:\\Users\\user pc\\Documents\\iReport\\server\\controller\\helper.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:102}},"2":{start:{line:8,column:20},end:{line:8,column:43}},"3":{start:{line:10,column:21},end:{line:10,column:58}},"4":{start:{line:12,column:14},end:{line:12,column:31}},"5":{start:{line:14,column:15},end:{line:14,column:46}},"6":{start:{line:16,column:39},end:{line:16,column:93}},"7":{start:{line:21,column:26},end:{line:21,column:106}},"8":{start:{line:21,column:38},end:{line:21,column:106}},"9":{start:{line:24,column:16},end:{line:24,column:106}},"10":{start:{line:24,column:51},end:{line:24,column:106}},"11":{start:{line:27,column:22},end:{line:27,column:112}},"12":{start:{line:27,column:28},end:{line:27,column:112}},"13":{start:{line:30,column:20},end:{line:30,column:85}},"14":{start:{line:30,column:29},end:{line:30,column:85}},"15":{start:{line:32,column:0},end:{line:32,column:46}},"16":{start:{line:33,column:0},end:{line:33,column:38}},"17":{start:{line:34,column:0},end:{line:34,column:26}},"18":{start:{line:35,column:0},end:{line:35,column:34}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:16,column:9},end:{line:16,column:31}},loc:{start:{line:16,column:37},end:{line:16,column:95}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:26},end:{line:21,column:27}},loc:{start:{line:21,column:38},end:{line:21,column:106}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:16},end:{line:24,column:17}},loc:{start:{line:24,column:51},end:{line:24,column:106}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:27,column:22},end:{line:27,column:23}},loc:{start:{line:27,column:28},end:{line:27,column:112}},line:27},"4":{name:"(anonymous_4)",decl:{start:{line:30,column:20},end:{line:30,column:21}},loc:{start:{line:30,column:29},end:{line:30,column:85}},line:30}},branchMap:{"0":{loc:{start:{line:16,column:46},end:{line:16,column:92}},type:"cond-expr",locations:[{start:{line:16,column:70},end:{line:16,column:73}},{start:{line:16,column:76},end:{line:16,column:92}}],line:16},"1":{loc:{start:{line:16,column:46},end:{line:16,column:67}},type:"binary-expr",locations:[{start:{line:16,column:46},end:{line:16,column:49}},{start:{line:16,column:53},end:{line:16,column:67}}],line:16}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_oydsjrny2.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_oydsjrny2.s[1]++;exports.verifyToken=exports.compare=exports.generateToken=exports.encryptedPassword=undefined;var _jsonwebtoken=(cov_oydsjrny2.s[2]++,require('jsonwebtoken'));var _jsonwebtoken2=(cov_oydsjrny2.s[3]++,_interopRequireDefault(_jsonwebtoken));var _bcrypt=(cov_oydsjrny2.s[4]++,require('bcrypt'));var _bcrypt2=(cov_oydsjrny2.s[5]++,_interopRequireDefault(_bcrypt));function _interopRequireDefault(obj){cov_oydsjrny2.f[0]++;cov_oydsjrny2.s[6]++;return(cov_oydsjrny2.b[1][0]++,obj)&&(cov_oydsjrny2.b[1][1]++,obj.__esModule)?(cov_oydsjrny2.b[0][0]++,obj):(cov_oydsjrny2.b[0][1]++,{default:obj});}// Encrypt password
// Helper functions
cov_oydsjrny2.s[7]++;const encryptedPassword=password=>{cov_oydsjrny2.f[1]++;cov_oydsjrny2.s[8]++;return _bcrypt2.default.hashSync(password,_bcrypt2.default.genSaltSync(8));};// Compare passwords
cov_oydsjrny2.s[9]++;const compare=(plainPassword,hashedPassword)=>{cov_oydsjrny2.f[2]++;cov_oydsjrny2.s[10]++;return _bcrypt2.default.compare(plainPassword,hashedPassword);};// Generate token
cov_oydsjrny2.s[11]++;const generateToken=id=>{cov_oydsjrny2.f[3]++;cov_oydsjrny2.s[12]++;return _jsonwebtoken2.default.sign({userId:id},process.env.SECRET,{expiresIn:'7d'});};// Verify yoken
cov_oydsjrny2.s[13]++;const verifyToken=token=>{cov_oydsjrny2.f[4]++;cov_oydsjrny2.s[14]++;return _jsonwebtoken2.default.verify(token,process.env.SECRET);};cov_oydsjrny2.s[15]++;exports.encryptedPassword=encryptedPassword;cov_oydsjrny2.s[16]++;exports.generateToken=generateToken;cov_oydsjrny2.s[17]++;exports.compare=compare;cov_oydsjrny2.s[18]++;exports.verifyToken=verifyToken;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhlbHBlci5qcyJdLCJuYW1lcyI6WyJlbmNyeXB0ZWRQYXNzd29yZCIsInBhc3N3b3JkIiwiYmNyeXB0IiwiaGFzaFN5bmMiLCJnZW5TYWx0U3luYyIsImNvbXBhcmUiLCJwbGFpblBhc3N3b3JkIiwiaGFzaGVkUGFzc3dvcmQiLCJnZW5lcmF0ZVRva2VuIiwiaWQiLCJqd3QiLCJzaWduIiwidXNlcklkIiwicHJvY2VzcyIsImVudiIsIlNFQ1JFVCIsImV4cGlyZXNJbiIsInZlcmlmeVRva2VuIiwidG9rZW4iLCJ2ZXJpZnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFQTs7OztBQUNBOzs7Ozs7QUFFQTtBQUxBOztBQU1BLE1BQU1BLG9CQUFvQkMsWUFBWUMsaUJBQU9DLFFBQVAsQ0FBZ0JGLFFBQWhCLEVBQTBCQyxpQkFBT0UsV0FBUCxDQUFtQixDQUFuQixDQUExQixDQUF0Qzs7QUFFQTtBQUNBLE1BQU1DLFVBQVUsQ0FBQ0MsYUFBRCxFQUFnQkMsY0FBaEIsS0FBbUNMLGlCQUFPRyxPQUFQLENBQWVDLGFBQWYsRUFBOEJDLGNBQTlCLENBQW5EOztBQUVBO0FBQ0EsTUFBTUMsZ0JBQWdCQyxNQUFNQyx1QkFBSUMsSUFBSixDQUFTLEVBQUVDLFFBQVFILEVBQVYsRUFBVCxFQUF5QkksUUFBUUMsR0FBUixDQUFZQyxNQUFyQyxFQUE2QyxFQUFFQyxXQUFXLElBQWIsRUFBN0MsQ0FBNUI7O0FBRUE7QUFDQSxNQUFNQyxjQUFjQyxTQUFTUix1QkFBSVMsTUFBSixDQUFXRCxLQUFYLEVBQWtCTCxRQUFRQyxHQUFSLENBQVlDLE1BQTlCLENBQTdCOztRQUdJZixpQixHQUFBQSxpQjtRQUFtQlEsYSxHQUFBQSxhO1FBQWVILE8sR0FBQUEsTztRQUFTWSxXLEdBQUFBLFciLCJmaWxlIjoiaGVscGVyLmpzIiwic291cmNlUm9vdCI6IkM6L1VzZXJzL3VzZXIgcGMvRG9jdW1lbnRzL2lSZXBvcnQvc2VydmVyL2NvbnRyb2xsZXIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIZWxwZXIgZnVuY3Rpb25zXHJcblxyXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0JztcclxuXHJcbi8vIEVuY3J5cHQgcGFzc3dvcmRcclxuY29uc3QgZW5jcnlwdGVkUGFzc3dvcmQgPSBwYXNzd29yZCA9PiBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIGJjcnlwdC5nZW5TYWx0U3luYyg4KSk7XHJcblxyXG4vLyBDb21wYXJlIHBhc3N3b3Jkc1xyXG5jb25zdCBjb21wYXJlID0gKHBsYWluUGFzc3dvcmQsIGhhc2hlZFBhc3N3b3JkKSA9PiBiY3J5cHQuY29tcGFyZShwbGFpblBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XHJcblxyXG4vLyBHZW5lcmF0ZSB0b2tlblxyXG5jb25zdCBnZW5lcmF0ZVRva2VuID0gaWQgPT4gand0LnNpZ24oeyB1c2VySWQ6IGlkIH0sIHByb2Nlc3MuZW52LlNFQ1JFVCwgeyBleHBpcmVzSW46ICc3ZCcgfSk7XHJcblxyXG4vLyBWZXJpZnkgeW9rZW5cclxuY29uc3QgdmVyaWZ5VG9rZW4gPSB0b2tlbiA9PiBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5TRUNSRVQpO1xyXG5cclxuZXhwb3J0IHtcclxuICAgIGVuY3J5cHRlZFBhc3N3b3JkLCBnZW5lcmF0ZVRva2VuLCBjb21wYXJlLCB2ZXJpZnlUb2tlbixcclxufTtcclxuIl19